table inet filter {
  chain input {
    type filter hook input priority 0;

    # Autoriser les connexions déjà établies
    ct state { established, related } accept

    # Loopback
    iif lo accept

    # ICMP / ICMPv6 pour diagnostic (ping, etc.)
    ip protocol icmp accept
    ip6 nexthdr icmpv6 accept

    # DNS public (IPv4 + IPv6, UDP + TCP)
    udp dport 53 accept
    tcp dport 53 accept

    # SSH sur port 50505 (on restreindra plus tard par IP source)
    tcp dport 50505 accept

    # Tout le reste rejeté
    reject
  }

  chain forward {
    type filter hook forward priority 0;
    drop
  }

  chain output {
    type filter hook output priority 0;
    accept
  }
}
